---
title: "[React Router/TypeScript/Material UI] ãƒ¢ãƒ¼ãƒ€ãƒ«ã«URLã‚’ä»˜ä¸ã™ã‚‹"
emoji: "ğŸº"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["React","TypeScript","ReactRuter","MaterialUI"]
published: true
---

React Routerã§ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’ç”¨æ„ã—ãŸã„ã¨æ€ã£ã¦ã„ãŸã¨ã“ã‚ã€ãƒ‰ãƒ³ãƒ”ã‚·ãƒ£ã®å®Ÿè£…ä¾‹ãŒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«å­˜åœ¨ã—ã¾ã—ãŸã€‚

- ãƒ¢ãƒ¼ãƒ€ãƒ«ã«å€‹åˆ¥ã®URLã‚’ä»˜ä¸ã—ãŸã„ã€‚
- åˆ¥ã®ã‚¿ãƒ–ã§URLã‚’æŒ‡å®šã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸå ´åˆã¯ãƒ¢ãƒ¼ãƒ€ãƒ«ã§ã¯ãªãé€šå¸¸ã®ãƒšãƒ¼ã‚¸ã§è¡¨ç¤ºã—ãŸã„ã€‚

[React Routerã®ãƒ¢ãƒ¼ãƒ€ãƒ«å®Ÿè£…ä¾‹](https://reactrouter.com/web/example/modal-gallery)

ã“ã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’ãƒ™ãƒ¼ã‚¹ã«ã€TypeScriptã¨Materil UIã‚’ä½¿ã£ã¦å®Ÿè£…ã—ã¦ã¿ã¾ã—ãŸã€‚

æœ¬è¨˜äº‹ã¯é‡è¦ãªéƒ¨åˆ†ã®æŠœç²‹ã®ã¿ã§ã™ã€‚ä»¥ä¸‹ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«å…¨ã‚³ãƒ¼ãƒ‰ãŒã‚ã‚Šã¾ã™ã€‚

https://github.com/urawa72/react-samples/tree/main/modal-url-sample



## æº–å‚™

Node.jsã¨yarnã¯ä»¥ä¸‹ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚

```shell
$ node -v
v14.15.4

$ yarn -v
1.22.10
```

Create React Appã§TypeScriptãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’åˆ©ç”¨ã—ãŸã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒªã‚’ä½œæˆã—ã¾ã™ã€‚

```shell
$ npx create-react-app modal-url-sample --template typescript
```

React Router, Material UIã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãŠãã¾ã™ã€‚
```shell
$ yarn add react-router-dom @material-ui/{core,icons}
```

## ã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒªã®å®Ÿè£…

ã¾ãšã¯ãƒ¢ãƒ¼ãƒ€ãƒ«ç”¨ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ç”¨æ„ã—ã¾ã™ã€‚[Material UIã®Customized dialogsã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰](https://material-ui.com/components/dialogs/#customized-dialogs)ã‚’å°‘ã—åŠ å·¥ã—ã¾ã™ã€‚`useParams`ã§URLã‹ã‚‰ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã‚ã‚‹idã‚’å–å¾—ã—ã¦è¡¨ç¤ºå†…å®¹ã«åˆ©ç”¨ã—ã¾ã™ï¼ˆå®Ÿéš›ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã“ã®idã‚’ä½¿ç”¨ã—ã¦APIã‚’ãŸãŸã„ã¦ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹æƒ³å®šã§ã™ï¼‰ã€‚

```typescript:src/components/SampleModal.tsx
const SampleModal: React.FC = () => {
  const history = useHistory();
  const { id } = useParams<{ id: string }>();
  const [open, setOpen] = React.useState(true);

  const handleClose = () => {
    history.goBack();
    setOpen(false);
  };

  return (
    <Dialog
      onClose={handleClose}
      aria-labelledby="customized-dialog-title"
      open={open}>
      <DialogTitle id="customized-dialog-title" onClose={handleClose}>
        Sample Modal Id: {id}
      </DialogTitle>
      <DialogContent dividers>
        <Typography gutterBottom>
          {[...Array(50)].map(() => `This is a sample modal ${id}!`)}
        </Typography>
      </DialogContent>
      <DialogActions>
        <Button autoFocus onClick={handleClose} color="primary">
          Save changes
        </Button>
      </DialogActions>
    </Dialog>
  );
};

export default SampleModal;
```

ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã®ãƒœã‚¿ãƒ³ã‚’ä¸¦ã¹ã‚‹ãƒšãƒ¼ã‚¸ã‚‚ç”¨æ„ã—ã¾ã™ã€‚`<Buttun>`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®`component`ã«React Routerã®`Link`ã‚’è¨­å®šã—`to`ã§`pathname`ã«é·ç§»å…ˆã®ãƒ‘ã‚¹ã‚’è¨­å®šã™ã‚‹ã“ã¨ã§ã€ãƒœã‚¿ãƒ³æŠ¼ä¸‹ã«ã‚ˆã‚‹ç”»é¢é·ç§»ãŒå®Ÿè£…ã§ãã¾ã™ã€‚ã¾ãŸã€`state: { background: location}`ã¯ã€Œã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ãƒ¢ãƒ¼ãƒ€ãƒ«ã¨ã—ã¦è¡¨ç¤ºã™ã‚‹ã‹ã€é€šå¸¸ã®ãƒšãƒ¼ã‚¸ã¨ã—ã¦è¡¨ç¤ºã™ã‚‹ã‹ã€ã®åˆ¤å®šã«ä½¿ç”¨ã•ã‚Œã‚‹ãŸã‚ã€é‡è¦ãªè¨­å®šå€¤ã§ã™ã€‚


```typescript:pages/Samples.tsx
import React from 'react';
import { Link, useLocation } from 'react-router-dom';
import Button from '@material-ui/core/Button';
import Typography from '@material-ui/core/Typography';

const data = [
  { id: 1, title: 'sample modal1', content: 'This is a sample modal 1!' },
  { id: 2, title: 'sample modal2', content: 'This is a sample modal 2!' },
  { id: 3, title: 'sample modal3', content: 'This is a sample modal 3!' },
  { id: 4, title: 'sample modal4', content: 'This is a sample modal 4!' },
];

const Samples: React.FC = () => {
  const location = useLocation();
  const buttonList = data.map((d) => (
    <Button
      variant="outlined"
      color="primary"
      component={Link}
      key={d.id}
      to={{
        pathname: `/samples/${d.id}`,
        state: { background: location },
      }}>
      Modal Button {d.id}
    </Button>
  ));
  return (
    <>
      <Typography variant="h4">Modal Samples</Typography>
      {buttonList}
    </>
  );
};

export default Samples;
```

æ¬¡ã«ã€é€šå¸¸ã®ãƒšãƒ¼ã‚¸ã§è¡¨ç¤ºã™ã‚‹æ™‚ç”¨ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ç”¨æ„ã—ã¾ã™ã€‚è¡¨ç¤ºã™ã‚‹å†…å®¹ã¯ãƒ¢ãƒ¼ãƒ€ãƒ«ã®ã‚¿ã‚¤ãƒˆãƒ«ãƒ»ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¨åŒæ§˜ã§ã™ã€‚

```typescript:src/components/SampleView.tsx
import React from 'react';
import { useParams } from 'react-router-dom';
import Typography from '@material-ui/core/Typography';

const SampleView: React.FC = () => {
  const { id } = useParams<{ id: string }>();

  return (
    <>
      <Typography variant="h4">Sample Modal Id: {id}</Typography>
      <Typography gutterBottom>
        {[...Array(50)].map(() => `This is a sample modal ${id}!`)}
      </Typography>
    </>
  );
};

export default SampleView;
```

æœ€å¾Œã«ã€ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®è¨­å®šã‚’ã—ã¾ã™ã€‚`useLocation()`ã§`location`ã‚’å–å¾—ã—ã€ã•ã‚‰ã«`location`ã‹ã‚‰`state.background`ã‚’å–å¾—ã—ã¾ã™ã€‚ãã—ã¦ã€`<Switch>`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®`location`ã¨ã„ã†ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã€å…ˆã»ã©å–å¾—ã—ãŸbackgroundã¾ãŸã¯locationã‚’è¨­å®šã—ã¾ã™ã€‚

ã“ã®`location`ã¨`background`ãŒãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã«ã©ã®ã‚ˆã†ã«å½±éŸ¿ã™ã‚‹ã‹ã¯ã®èª¬æ˜ã¯å¾Œå›ã—ã«ã—ã€ä¸€æ—¦ã“ã‚Œã§å‹•ä½œç¢ºèªã—ã¾ã™ã€‚

```typescript:src/App.tsx
import React from 'react';
import * as H from 'history';
import { Route, Switch, useLocation } from 'react-router-dom';
import Top from './pages/Top';
import Samples from './pages/Samples';
import SampleModal from './components/SampleModal';
import SampleView from './components/SampleView';

const App: React.FC = () => {
  const location = useLocation<{ background: H.Location }>();
  const background = location?.state?.background;

  return (
    <>
      <Switch location={background || location}>
        <Route exact path="/">
          <Top />
        </Route>
        <Route exact path="/samples">
          <Samples />
        </Route>
        <Route exact path="/samples/:id">
          <SampleView />
        </Route>
      </Switch>
      {background && (
        <Route exact path="/samples/:id">
          <SampleModal />
        </Route>
      )}
    </>
  );
};

export default App;
```


## å‹•ä½œç¢ºèª

`/samples`ç”»é¢ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€é©å½“ãªãƒœã‚¿ãƒ³ã‚’æŠ¼ä¸‹ã™ã‚‹ã¨ãƒ¢ãƒ¼ãƒ€ãƒ«ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ã¾ãŸã€ã“ã®ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤ºã—ãŸã¨ãã«ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒ¼ã®URLãŒãƒ¢ãƒ¼ãƒ€ãƒ«ç”¨ã®URLã«å¤‰ã‚ã£ã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯æ„å›³é€šã‚Šã®æŒ™å‹•ã§ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/0ehq1ajyisvspwqscyd8do9pgl92)


æ¬¡ã«ã€ã“ã®ãƒ¢ãƒ¼ãƒ€ãƒ«ã®URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¦åˆ¥ã‚¿ãƒ–ã§é–‹ãã¾ã™ã€‚ã™ã‚‹ã¨ã€ãƒ¢ãƒ¼ãƒ€ãƒ«ã§ã¯ãªãé€šå¸¸ã®ãƒšãƒ¼ã‚¸ã§ä¸Šè¨˜ã®ãƒ¢ãƒ¼ãƒ€ãƒ«ã¨åŒæ§˜ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ã“ã‚Œã‚‚æ„å›³é€šã‚Šã®æŒ™å‹•ã§ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/4zlrft6ufbcxgc4r1az4qf4feahz)



## `<Switch>`ã®`location`ã«ã¤ã„ã¦


> - ãƒ¢ãƒ¼ãƒ€ãƒ«ã«å€‹åˆ¥ã®URLã‚’ä»˜ä¸ã—ãŸã„ã€‚
> - åˆ¥ã®ã‚¿ãƒ–ã§URLã‚’æŒ‡å®šã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸå ´åˆã¯ãƒ¢ãƒ¼ãƒ€ãƒ«ã§ã¯ãªãé€šå¸¸ã®ãƒšãƒ¼ã‚¸ã§è¡¨ç¤ºã—ãŸã„ã€‚

ä¸Šè¨˜ã‚’å®Ÿè£…ã™ã‚‹ãŸã‚ã®é‡è¦ãªç‚¹ã¯ã€`src/App.tsx`ã®`<Switch>`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§æŒ‡å®šã—ã¦ã„ã‚‹`location`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§ã™ã€‚`location`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒ¼ã«è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹URLã¨ã¯ç•°ãªã‚‹URLã‚’ç”¨ã„ã¦ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚

> A location object to be used for matching children elements instead of the current history location (usually the current browser URL).

å‚è€ƒ: [location](https://reactrouter.com/web/api/Switch/location-object)

`/samples`ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã¨ãã®`location`ã¨`background`ã¯ä»¥ä¸‹ã®å†…å®¹ã§ã™ã€‚

```javascript
location: {pathname: "/samples", search: "", hash: "", state: undefined, key: "bghv4g"}
background: undefined
```

`/samples/1`ã§ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤ºã—ãŸã¨ãã¯ä»¥ä¸‹ã«ãªã‚Šã¾ã™ã€‚

```javascript
location: {pathname: "/samples/1", state: { background: {pathname: "/samples", search: "", hash: "", state: undefined, key: "bghv4g"} }, search: "", hash: "", key: "w8evpp"}
background: {pathname: "/samples", search: "", hash: "", state: undefined, key: "bghv4g"}
```

ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®ã‚³ãƒ¼ãƒ‰ã ã‘æŠœç²‹ã—ã¦å†æ²ã—ã¾ã™ã€‚

ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤ºæ™‚ã€`background`ã«ã¯ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒ¼ã«ç¾åœ¨è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹URLï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«ã®URLï¼‰ã®ãƒ‘ã‚¹ã§ã¯ãªããƒ¢ãƒ¼ãƒ€ãƒ«ã®è¡¨ç¤ºå…ƒãƒšãƒ¼ã‚¸ã®URLã®ãƒ‘ã‚¹ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã®ã§ã€`<Switch>`å†…ã§ã¯`/samples`ãŒãƒ¢ãƒ¼ãƒ€ãƒ«ã®èƒŒæ™¯ãƒšãƒ¼ã‚¸ã¨ã—ã¦æç”»ã•ã‚Œã¾ã™ï¼ˆæ—¢ã«è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã®ã§ç”»é¢ã®å¤‰åŒ–ã¯ãªã„ï¼‰ã€‚

```typescript:src/App.tsx
// backgroundãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯backgroundã‚’å…ƒã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãŒè¡Œã‚ã‚Œã‚‹
<Switch location={background || location}>
  <Route exact path="/">
    <Top />
  </Route>
  <Route exact path="/samples">
    <Samples />
  </Route>
  <Route exact path="/samples/:id">
    <SampleView />
  </Route>
</Switch>
```

`<Switch>`å†…ã®åˆ¤å®šçµ‚äº†å¾Œã€ã•ã‚‰ã«`<Switch>`å¤–ã«å­˜åœ¨ã™ã‚‹ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚‚å‡¦ç†ã•ã‚Œã¾ã™ã€‚`background`ãŒå­˜åœ¨ã™ã‚‹æ™‚ã€`<SampleModal />`ãŒæç”»ã•ã‚Œã¾ã™ã€‚ã“ã‚ŒãŒãƒ¢ãƒ¼ãƒ€ãƒ«ã®è¡¨ç¤ºã‚’æ‹…ã£ã¦ã„ã¾ã™ã€‚

```typescript:src/App.tsx
    <>
      {background && (
        <Route exact path="/samples/:id">
          <SampleModal />
        </Route>
      )}
    </>
```

åˆ¥ã®ã‚¿ãƒ–ã§URLã‚’æŒ‡å®šã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸå ´åˆã€`background`ã¯å­˜åœ¨ã—ãªã„ãŸã‚`location`ï¼ˆã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒ¼ã«è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹`/sample/1`ã¨ã„ã†ãƒ‘ã‚¹ï¼‰ã‚’å…ƒã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã•ã‚Œã¾ã™ã€‚ãã®çµæœã€`<SampleView />`ã®ã¿ãŒæç”»ã•ã‚Œãƒ¢ãƒ¼ãƒ€ãƒ«ã¯è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚

```typescript:src/App.tsx
// backgroundãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯backgroundã‚’å…ƒã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãŒè¡Œã‚ã‚Œã‚‹
<Switch location={background || location}>
  <Route exact path="/">
    <Top />
  </Route>
  <Route exact path="/samples">
    <Samples />
  </Route>
  <Route exact path="/samples/:id">
    <SampleView />
  </Route>
</Switch>
```


## ãŠã‚ã‚Šã«

ã‚„ã‚ŠãŸã„ã“ã¨ã«å®Œå…¨ã«ãƒãƒƒãƒã—ãŸå®Ÿè£…ãŒè¦‹ã¤ã‹ã£ã¦è‰¯ã‹ã£ãŸâ€¦ã€‚`<Switch>`ã«ãŠã‘ã‚‹`location`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®æŒ™å‹•ã‚’èª¿ã¹ã‚‹ãã£ã‹ã‘ã«ã‚‚ãªã£ãŸã®ã§ä¸€çŸ³äºŒé³¥ã§ã—ãŸã€‚
